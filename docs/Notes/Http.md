# 网络

## 网络模型

网络模型一般是指 OSI 七层参考模型和 TCP/IP 五层参考模型。

![xrYjDx.png](https://s1.ax1x.com/2022/10/18/xrYjDx.png)

每一层实现各自的功能和协议,并且都为上一层提供业务功能。为了提供这种业务功能,下一层将上一层中的数据并入到本层的数据域中,然后通过加入报头或报尾来实现该层业务功能,该过程叫做数据封装。用户的数据要经过一次次包装,最后转化成可以在网络上传输的信号,发送到网络上。当到达目标计算机后,再执行相反的数据拆包过程。

### OSI七层网络模型

可以看到在OSI网络模型中，每一层划分的很精细、功能很聚焦，这样有利于标准化的制定。因为每一层只要关注自己那块的功能就行，层与层之间只要按照协议进行数据交互就能跑起来。

![xrti2d.png](https://s1.ax1x.com/2022/10/18/xrti2d.png)

`物理层`

主要定义物理设备标准，如网线的接口类型、光纤的接口类型、各种传输介质的传输速率等。
主要作用是将数据最终编码为用0、1标识的比特流，通过物理介质传输。
这一层的数据叫做比特。

`数据链路层`

主要将接收到的数据进行MAC地址(网卡地址)的封装与解封装。
常把这一层的数据叫做帧。
这一层常工作的设备是交换机。

`网络层`

主要将接收到的数据进行IP 地址的封装与解封装。
常把这一层的数据叫做数据包。
这一层设备是路由器。

`传输层`

定义了一些数据传输的协议和端口号。
主要将接收的数据进行分段和传输,到达目的地址后在进行重组。
常把这一层的数据叫做段。

`会话层`

通过传输层建立数据传输的通路。
主要在系统之间发起会话或者接收会话请求。

`表示层`

主要进行对接收数据的解释、加密与解密、压缩与解压缩。
确保一个系统的应用层发送的数据能被另一个系统的应用层识别。

`应用层`

主要是为一些终端应用程序提供服务，直接面对着用户的。



理想是丰满的，现实是骨感的。OSI模型也败在它层次划分的太过学术、太过精细，具体实施起来会存在以下问题：

1. 制定OSI网络模型的专家们偏学术，缺乏商业驱动能力；
2. 协议实现太过复杂，运行效率低；
3. 协议多导致协议制定周期长，导致按照OSI协议实现的设备从设计到进入市场的周期太长；
4. 层次划分不太合理，有些层次的功能重叠了。



### TCP/IP四层网络模型

不同于OSI网络模型，在TCP/IP网络模型中，网络被划分为四层：把OSI网络模型中功能重叠、或者相似网络层次进行了合并，如图。最终，体系结构更加简单的TCP/IP网络体系结构，经过了商业化的洗礼取代了OSI网络体系结构最终成为事实上的标准。

### 五层网络模型

不过在学习计算机网络时，将OSI网络模型与TCP/IP网络模型进行了合并，在TCP/IP网络模型中的网络接口层按照OSI网络模型划分为数据链路层和物理层。

![xrtRiD.png](https://s1.ax1x.com/2022/10/18/xrtRiD.png)

### 五层网络模型介绍

网络诞生的目的是解决不同主机上的进程通信问题。 我们来看看五层网络模型是如何分工协作进行不同主机间的进程通信的吧。

假如主机A上的进程a（在应用层）想发送到主机B上的进程b：

1. 物理层（建立物理连接，传输二进制流）。那么首先摆在面前的第一个问题就是主机A与主机B之间得有一条物理链路（有线、无线）进行数据传输，否则通信无从谈起；所以物理层的作用便是在主机之间搭建一条物理链路传输二进制流（即0与1，与协议无关）。
2. 数据链路层（局域网，主机间通信）。物理链路联通以后主机之间就具备了数据传输的基础能力，但是物理链路上是无协议的，传输的是二进制流；二进制流意味着没有起始标识符，接收的主机不知道什么时候开始解析数据，也不知道什么时候终止数据的接收；于是在数据链路层上对发送的数据进行了封装：分装成帧（frame）；这样主机在接收二进制流时就知道什么时候开始，什么时候结束。
3. 网络层（网络路由，主机间通信）。当物理层和数据链路层准备就绪以后，另外的问题出现了：计算机网络中存在大量的主机，那么主机A如何找到主机B呢？即网络路由寻址能力；在网络层最出名的协议莫过于IP协议（Internet Protocol）。在特定的网络下，每台主机都分配了一个唯一IP地址，配合路由器的IP路由寻址，主机A就能通过IP协议找到主机B了；也就意味着主机A与主机B之间具备了数据传输能力。
4. 传输层（进程间通信）。主机之间具备传输功能之后，那么更近一步把数据发送到指定端口即可完成一次不同主机间的进程通信了；记住传输层并不是数据传输的地方，而是控制数据如何传输的地方：面向连接还是无连接，传输的拥塞控制等。
5. 应用层（发送与接收数据）。主机B上的进程b只要监听特定的端口号，那么就能够收到主机A上的进程a发送过来的数据了。

![xrNZl9.png](https://s1.ax1x.com/2022/10/18/xrNZl9.png)

![xrNSLq.png](https://s1.ax1x.com/2022/10/18/xrNSLq.png)



## TCP和UDP协议的原理和区别

### 一、作用

首先，tcp和udp都是工作在传输层，用于程序之间传输数据的。数据一般包含：文件类型、视频类型、图片类型等。

### 二、区别

tcp是基于连接的，而udp是基于非连接的。

tcp传输数据稳定可靠，适用于对网络通讯质量要求较高的场景，需要准确无误的传输给对方，比如，传输文件，发送邮件，浏览网页等。

upd的优点是速度快，但是可能产生丢包，所有适用于对实时性要求比较高但是对少量丢包并没有太大要求的场景。比如：语音通话、视频直播等。udp还有一个非常重要的应用场景就是隧道网络，比如VXLAN。

以人与人之间的通信为例：UDP协议相当于写信给对方，寄出去信后你不知道对方是否收到，信件内容是否完整，也得不到即使的反馈。而TCP协议就像是打电话，在这一系列流程中都能得到及时反馈，并能确保对方及时接收到。

![xrrbTA.png](https://s1.ax1x.com/2022/10/18/xrrbTA.png)
